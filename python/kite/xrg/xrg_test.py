import numpy as np
import pandas as pd
import xrg

if __name__ == "__main__":

	data = b'XRG1\x04\x00\x01\x00\x00\x00\x08\x00\x00\x00\x00\x00(\x00\x00\x00(\x00\x00\x00\x00\x00\x00\x00\x05\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00\x02\x00\x00\x00\x00\x00\x00\x00\x03\x00\x00\x00\x00\x00\x00\x00\x04\x00\x00\x00\x00\x00\x00\x00\x05\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'

	arr = b'XRG1\x08\x00\x08\x00\x01\x00\xff\xff\x00\x00\x00\x00\xc8\x00\x00\x00\xc8\x00\x00\x00\x00\x00\x00\x00\x05\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00$\x00\x00\x00$\x00\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00\x06\x00\x01\x00\x03\x00\x00\x00\x01\x00\x00\x00\x00\x00\x80?\x00\x00\x00@\x00\x00@@$\x00\x00\x00$\x00\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00\x06\x00\x01\x00\x03\x00\x00\x00\x01\x00\x00\x00\x00\x00\x00@\x00\x00@@\x00\x00\x80@$\x00\x00\x00$\x00\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00\x06\x00\x01\x00\x03\x00\x00\x00\x01\x00\x00\x00\x00\x00\x80@\x00\x00\xa0@\x00\x00\xc0@$\x00\x00\x00$\x00\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00\x06\x00\x01\x00\x03\x00\x00\x00\x01\x00\x00\x00\x00\x00\x80?\x00\x00\x80@\x00\x00@@$\x00\x00\x00$\x00\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00\x06\x00\x01\x00\x03\x00\x00\x00\x01\x00\x00\x00\x00\x00\xa0@\x00\x00\xe0@\x00\x00@@\x00\x00\x00\x00\x00\x00\x00\x00'

	#hdr = VectorHeader.read(data)
	#print(hdr)
	#hdr = VectorHeader.read(ByteBuffer.wrap(bytearray(data)))

	v = xrg.Vector(bytearray(data))
	print(v.header)
	print(v.values)

	a = xrg.Vector(bytearray(arr))
	print(a.header)
	print(a.flag)
	for i in a.values:
		print(i)

	print("iterator")
	iter = xrg.XrgIterator([a])
	while True:
		curr = iter.next()
		if curr is None:
			break
			
		print("values...")
		print(curr.values)
		print("flags...")
		print(curr.flags)


	df = iter.to_pandas()
	print(df)



